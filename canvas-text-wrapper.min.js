!function(a){function b(b,c,d){"use strict";function e(a){B||(B=s.sizeToFill?u.font.split(/\b\d+px\b/i):s.font.split(/\b\d+px\b/i)),u.font=B[0]+a+"px"+B[1]}function f(){isNaN(s.lineHeight)?s.lineHeight.toString().indexOf("px")!==-1?L=parseInt(s.lineHeight):s.lineHeight.toString().indexOf("%")!==-1&&(L=parseInt(s.lineHeight)/100*G):L=G*s.lineHeight}function g(){if(s.sizeToFill){var a=c.trim().split(/\s+/).length,b=0;do h(++b);while(H<F&&I.join(" ").split(/\s+/).length==a);h(--b)}else i();s.justifyLines&&"auto"===s.lineBreak&&l(),p(),o(),n()}function h(a){e(a),L=a,i()}function i(){if(s.allowNewLine)for(var a=c.trim().split("\n"),b=0,d=0;b<a.length-1;b++)d+=a[b].trim().split(/\s+/).length,J.push(d);var e=c.trim().split(/\s+/);j(e),k(e),H=I.length*L}function j(a){var b,c,d,e;a.forEach(function(f,g){if(b="",c=u.measureText(f).width,c>E){for(var h=0;u.measureText(b+f[h]).width<=E&&h<f.length;h++)b+=f[h];d=f.slice(0,h),e=f.slice(h),a.splice(g,1,d,e)}})}function k(a){I=[];for(var b=0,c=0;b<a.length;c++)if(I[c]="","auto"===s.lineBreak){if(u.measureText(I[c]+a[b]).width>E)break;for(;u.measureText(I[c]+a[b]).width<=E&&b<a.length;)if(I[c]+=a[b]+" ",b++,s.allowNewLine)for(var d=0;d<J.length;d++)if(J[d]===b){c++,I[c]="";break}I[c]=I[c].trim()}else I[c]=a[b],b++}function l(){for(var a,b,c,d=0;d<I.length;d++)c=u.measureText(I[d]).width,(!a||c>a)&&(a=c,b=d);var e,f,g,h,i,j="â€Š";for(d=0;d<I.length;d++)if(d!==b&&(e=I[d].trim().split(/\s+/).length,!(e<=1))){I[d]=I[d].trim().split(/\s+/).join(j),f=u.measureText(j).width,g=(a-u.measureText(I[d]).width)/f,h=g/(e-1),i="";for(var k=0;k<h;k++)i+=j;I[d]=I[d].trim().split(j).join(i)}}function m(a,b,c){var d=u.measureText(a).width;switch(u.textAlign){case"center":b-=d/2;break;case"right":b-=d}u.beginPath(),u.moveTo(b,c),u.lineTo(b+d,c),u.stroke()}function n(){for(var a=0;a<I.length;a++)K.y=parseInt(K.y)+L,u.fillText(I[a],K.x,K.y),s.strokeText&&u.strokeText(I[a],K.x,K.y),"underline"===s.textDecoration.toLocaleLowerCase()&&m(I[a],K.x,K.y)}function o(){u.textAlign=s.textAlign,"center"==s.textAlign?K.x=(C+s.paddingLeft-s.paddingRight)/2:"right"==s.textAlign?K.x=C-s.paddingRight:K.x=s.paddingLeft}function p(){if("middle"==s.verticalAlign){const a=D-s.paddingTop-s.paddingBottom,b=s.paddingTop+a/2;K.y=b-H/2}else"bottom"==s.verticalAlign?K.y=D-H-s.paddingBottom:K.y=s.paddingTop}function q(){if("string"!=typeof c)throw new TypeError("The second parameter must be a String.");if(isNaN(G))throw new TypeError('Cannot parse "font".');if(isNaN(L))throw new TypeError('Cannot parse "lineHeight".');if("left"!==s.textAlign.toLocaleLowerCase()&&"center"!==s.textAlign.toLocaleLowerCase()&&"right"!==s.textAlign.toLocaleLowerCase())throw new TypeError('Property "textAlign" must be set to either "left", "center", or "right".');if("top"!==s.verticalAlign.toLocaleLowerCase()&&"middle"!==s.verticalAlign.toLocaleLowerCase()&&"bottom"!==s.verticalAlign.toLocaleLowerCase())throw new TypeError('Property "verticalAlign" must be set to either "top", "middle", or "bottom".');if("boolean"!=typeof s.justifyLines)throw new TypeError('Property "justifyLines" must be a Boolean.');if(isNaN(s.paddingLeft))throw new TypeError('Property "paddingLeft" must be a Number.');if(isNaN(s.paddingRight))throw new TypeError('Property "paddingRight" must be a Number.');if(isNaN(s.paddingTop))throw new TypeError('Property "paddingTop" must be a Number.');if(isNaN(s.paddingBottom))throw new TypeError('Property "paddingBottom" must be a Number.');if("boolean"!=typeof s.fitParent)throw new TypeError('Property "fitParent" must be a Boolean.');if("auto"!==s.lineBreak.toLocaleLowerCase()&&"word"!==s.lineBreak.toLocaleLowerCase())throw new TypeError('Property "lineBreak" must be set to either "auto" or "word".');if("boolean"!=typeof s.sizeToFill)throw new TypeError('Property "sizeToFill" must be a Boolean.');if("boolean"!=typeof s.strokeText)throw new TypeError('Property "strokeText" must be a Boolean.');if("boolean"!=typeof s.renderHDPI)throw new TypeError('Property "renderHDPI" must be a Boolean.');if("none"!==s.textDecoration.toLocaleLowerCase()&&"underline"!==s.textDecoration.toLocaleLowerCase())throw new TypeError('Property "textDecoration" must be set to either "none" or "underline".')}var r={font:"18px Arial, sans-serif",sizeToFill:!1,lineHeight:1,allowNewLine:!0,lineBreak:"auto",textAlign:"left",verticalAlign:"top",justifyLines:!1,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,fitParent:!1,strokeText:!1,renderHDPI:!0,textDecoration:"none"},s={};for(var t in r)s[t]=d.hasOwnProperty(t)?d[t]:r[t];var u=b.getContext("2d");u.font=s.font,u.textBaseline="bottom";var v=1,w="undefined"!=typeof global?global.devicePixelRatio:a.devicePixelRatio;if(s.renderHDPI&&w>1){var x={};for(var t in u)x[t]=u[t];var y=b.width,z=b.height;v=w,b.width=y*v,b.height=z*v,b.style.width=y*v*.5+"px",b.style.height=z*v*.5+"px";for(var t in x)try{u[t]=x[t]}catch(A){}u.scale(v,v)}var B,C=(s.fitParent?b.parentNode.clientWidth:b.width)/v,D=(s.fitParent?b.parentNode.clientHeight:b.height)/v,E=C-(s.paddingLeft+s.paddingRight),F=D-(s.paddingTop+s.paddingBottom),G=s.font.match(/\d+(px|em|%)/g)?+s.font.match(/\d+(px|em|%)/g)[0].match(/\d+/g):18,H=0,I=[],J=[],K={x:0,y:0},L=0;e(G),f(),q(),g()}"module"in a&&"exports"in module?module.exports=b:a.CanvasTextWrapper=b}(this);